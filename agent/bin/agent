#!/var/vmc/bin/ruby
#
ENV["BUNDLE_GEMFILE"] ||= File.expand_path("../../Gemfile", __FILE__)

require "rubygems"
require "bundler/setup"

$LOAD_PATH.unshift(File.dirname(__FILE__) + "/../lib")

require "agent"

# Defaults
options = {
  "configure" => false,
  "logging" => { "level" => "DEBUG" },
  "redis" => { "host" => "localhost" },
  "agent_id" => "not_configured",
  "base_dir" => "/var/vmc"
}

opts = OptionParser.new do |opts|
  opts.on("-c", "--configure", "Invoke") do |opt|
    options["configure"] = true
  end

  opts.on("-a", "--agent_id String", "Agent ID") do |opt|
    options["agent_id"] = opt
  end

  opts.on("-b", "--base_dir String", "Base directory") do |opt|
    options["base_dir"] = opt
  end
end
opts.parse!(ARGV.dup)

Bosh::Agent.run(options)
